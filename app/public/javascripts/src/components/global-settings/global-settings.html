<style scoped>
  #global-settings {
    display: flex;
    flex-wrap: wrap
  }

  .settings-btn {
    width: calc(33.33333% - 20px);
    margin: 10px;
    height: 100px
  }

  .notification .badge {
    position: relative;
    top: -63px;
    right: -10px;
    padding: 5px 10px;
    border-radius: 50%;
    background-color: red;
    color: white;
  }
</style>
<modal visible="$ctrl.state.showGlobalSettings"
  modal-size="($ctrl.currentView === $ctrl.views.MANAGE_USERS || $ctrl.currentView === $ctrl.views.REPORTS_EDITOR) ? 'modal-lg' : 'modal-md'"
  backdrop="static" on-hide="$ctrl.modalHide()">
  <modal-header title="{{$ctrl.currentView}}"></modal-header>
  <modal-body style="height: 500px;overflow: auto;">

    <div id="global-settings" ng-if="$ctrl.currentView === $ctrl.views.GLOBAL_SETTINGS">
      <button class="btn btn-light settings-btn" ng-click="$ctrl.currentView = $ctrl.views.MY_ACCOUNT">
        <i class="fa fa-2x fa-user"></i>
        <br>My Account
      </button>

      <button class="btn btn-light settings-btn" ng-if="$ctrl.state.configuration.perspective.globalSettings.showMultiFactorAuthentication"
              ng-click="$ctrl.currentView = $ctrl.views.MULTIFACTOR_AUTHENTICATION">
        <i class="fa fa-2x fa-user-shield"></i>
        <br>Multi Factor Authentication
      </button>

      <button class="btn btn-light settings-btn" ng-if="$ctrl.state.loggedInUser.isAdministrator" ng-click="$ctrl.currentView = $ctrl.views.MANAGE_USERS">
        <i class="fa fa-2x fa-users"></i>
        <br>Manage Users
      </button>

      <button class="btn btn-light settings-btn" ng-if="$ctrl.state.loggedInUser.isAdministrator" ng-click="$ctrl.currentView = $ctrl.views.MANAGE_GROUPS">
        <i class="fa fa-2x fa-users"></i>
        <br>Manage Groups
      </button>

      <button class="btn btn-light settings-btn" ng-click="$ctrl.openUserSettingsForUserId($ctrl.state.loggedInUser.id)">
        <i class="fa fa-2x fa-cogs"></i>
        <br>User Settings
      </button>

      <button class="btn btn-light settings-btn" ng-if="$ctrl.state.loggedInUser.isAdministrator" ng-click="$ctrl.currentView = $ctrl.views.TAG_MANAGER">
        <i class="fa fa-2x fa-tags"></i>
        <br>Tag Manager
      </button>

      <button class="btn btn-light settings-btn notification" ng-click="$ctrl.currentView = $ctrl.views.RELEASE_NOTES">
        <i class="fa fa-2x fa-bell"></i>
        <br>Release Notes
        <!-- <span class="badge">!</span> -->
      </button>

      <button class="btn btn-light settings-btn" ng-if="$ctrl.state.loggedInUser.isAdministrator" ng-click="$ctrl.currentView = $ctrl.views.CONFIGURATION_EDITOR">
        <i class="fa fa-2x fa-sliders-h"></i>
        <br>Configuration Editor
      </button>
      
      <button class="btn btn-light settings-btn" ng-if="$ctrl.state.loggedInUser.isAdministrator" ng-click="$ctrl.currentView = $ctrl.views.REPORTS_EDITOR">
        <i class="fas fa-2x fa-file-download"></i>
        <br>Reports Editor
      </button>

      <button class="btn btn-light settings-btn" ng-click="$ctrl.uploadDataSource()">
        <i class="fa fa-2x fa-upload"></i>
        <br>Data Upload
      </button>

      <button class="btn btn-light settings-btn" ng-if="$ctrl.state.loggedInUser.isAdministrator" ng-click="$ctrl.currentView = $ctrl.views.BROADCAST">
        <i class="fa fa-2x fa-bullhorn"></i>
        <br>BroadCast
      </button>
    </div>

    <user-account-settings ng-if="$ctrl.currentView === $ctrl.views.MY_ACCOUNT"></user-account-settings>

    <multifactor-settings ng-if="$ctrl.currentView === $ctrl.views.MULTIFACTOR_AUTHENTICATION && $ctrl.state.configuration.perspective.globalSettings.showMultiFactorAuthentication">
    </multifactor-settings>

    <manage-users ng-if="$ctrl.currentView === $ctrl.views.MANAGE_USERS"
                  manager-view="$ctrl.globalSettingsService.currentManageUserView"
                  open-user-settings-for-user-id="$ctrl.openUserSettingsForUserId(userId)">
    </manage-users>

    <manage-groups ng-if="$ctrl.currentView === $ctrl.views.MANAGE_GROUPS" manager-view="$ctrl.globalSettingsService.currentManageUserView">
    </manage-groups>

    <user-settings ng-if="$ctrl.currentView === $ctrl.views.USER_SETTINGS"
                   user-id="$ctrl.userIdForSettingsEdit">
    </user-settings>

    <tag-manager ng-if="$ctrl.currentView === $ctrl.views.TAG_MANAGER" manager-view="$ctrl.globalSettingsService.currentTagManagerView">
    </tag-manager>

    <release-notes ng-if="$ctrl.currentView === $ctrl.views.RELEASE_NOTES"
      release-notes-view="$ctrl.globalSettingsService.currentReleaseNotesView">
    </release-notes>

    <r-broadcast ng-if="$ctrl.currentView === $ctrl.views.BROADCAST"></r-broadcast>
    
    <r-configuration-editor ng-if="$ctrl.currentView === $ctrl.views.CONFIGURATION_EDITOR">
    </r-configuration-editor>

    <r-report-module-list ng-if="$ctrl.currentView === $ctrl.views.REPORTS_EDITOR">
    </r-report-module-list>
  </modal-body>

  <modal-footer>
    <!-- Close button - show when we are in "Global Settings" mode -->
    <button ng-if="$ctrl.currentView === $ctrl.views.GLOBAL_SETTINGS" class="btn btn-primary" ng-click="$ctrl.modalHide()">Close</button>

    <button ng-if="$ctrl.currentView === $ctrl.views.MY_ACCOUNT" type="submit" class="btn btn-primary" ng-click="$ctrl.globalSettingsService.save()">Update settings</button>

    <a ng-if="$ctrl.currentView === $ctrl.views.MANAGE_USERS && $ctrl.globalSettingsService.currentManageUserView === $ctrl.globalSettingsService.ManageUserViews.Users"\
       type="button" class="btn btn-light" ng-href='/admin/users/csv'>Download CSV</a>
    <a ng-if="$ctrl.currentView === $ctrl.views.MANAGE_USERS && $ctrl.globalSettingsService.currentManageUserView === $ctrl.globalSettingsService.ManageUserViews.Users"
       type="button" class="btn btn-light" ng-click="$ctrl.globalSettingsService.openSendMailView()">Send email to all users</a>
    <a ng-if="$ctrl.currentView === $ctrl.views.MANAGE_USERS && $ctrl.globalSettingsService.currentManageUserView === $ctrl.globalSettingsService.ManageUserViews.Users && $ctrl.state.configuration.perspective.globalSettings.showRegisterUser"
       type="button" class="btn btn-light" ng-if="$ctrl.state.configuration.perspective.globalSettings.showRegisterUser"
       ng-click="$ctrl.globalSettingsService.openNewUserView()">Register a new user</a>

    <button ng-if="$ctrl.globalSettingsService.currentManageUserView === $ctrl.globalSettingsService.ManageUserViews.SendEmail" type="button" class="btn btn-primary" ng-click="$ctrl.globalSettingsService.sendMail()">Send mail</button>

    <button ng-if="$ctrl.currentView === $ctrl.views.TAG_MANAGER && $ctrl.globalSettingsService.currentTagManagerView === $ctrl.globalSettingsService.TagManagerViews.Tags" type="submit" class="btn btn-primary" ng-click="$ctrl.globalSettingsService.currentTagManagerView = $ctrl.globalSettingsService.TagManagerViews.CreateTag">Create Tag</button>

    <button ng-if="$ctrl.currentView === $ctrl.views.TAG_MANAGER && $ctrl.globalSettingsService.currentTagManagerView === $ctrl.globalSettingsService.TagManagerViews.UpdateTag" type="submit" class="btn btn-primary" ng-click="$ctrl.globalSettingsService.updateTag()">Update Tag</button>
    <button ng-if="$ctrl.currentView === $ctrl.views.TAG_MANAGER && $ctrl.globalSettingsService.currentTagManagerView === $ctrl.globalSettingsService.TagManagerViews.CreateTag" type="submit" class="btn btn-primary" ng-click="$ctrl.globalSettingsService.createTag()">Create Tag</button>

    <button ng-if="$ctrl.currentView !== $ctrl.views.GLOBAL_SETTINGS" class="btn btn-primary float-right" ng-click="$ctrl.goBack()">Back</button>

  </modal-footer>
</modal>
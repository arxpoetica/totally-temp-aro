<style scoped>
  #tblUsers td {
    line-height: 33px;
  }
</style>
<div ng-if="$ctrl.managerView === $ctrl.globalSettingsService.ManageUserViews.Users" style="display: flex; flex-direction: column; height: 100%;">
  <div style="flex: 0 0 auto;">
    <div class="pull-right input-group" style="max-width: 250px;">
      <input class="form-control" type="text" ng-model="$ctrl.searchText" ng-keyup="$ctrl.onSearchKeyUp($event)">
      <span class="input-group-btn">
        <button class="btn btn-default" type="button" ng-click="$ctrl.filterUsers(true)"><i class="fa fa-search"></i></button>
      </span>
    </div>
  </div>
  <div style="flex: 1 1 auto; overflow-y: auto;">
    <table id="tblUsers" class="table table-striped table-condensed">
      <thead>
        <tr>
          <th>
            Name
          </th>
          <th>
            Email
          </th>
          <th>
            Role
          </th>
          <th>
            Groups
          </th>
          <th>
            Actions
          </th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="user in $ctrl.filteredUsers">
          <td>{{user.firstName}} {{user.lastName}}</td>
          <td>{{user.email}}</td>
          <td>
            <select class="form-control"
                    ng-model="user.rol"
                    ng-options="item.rol as item.rol for item in $ctrl.userTypes">
            </select>
          </td>
          <td>
            <aro-multi-select model="user.userGroups"
                              all-items="$ctrl.allGroups">
            </aro-multi-select>
          </td>
          <td>
            <div class="pull-right">
              <input type="text" id="resend-link-input-{{ user.id }}" value="{{user.resend_link}}" style="position: absolute; margin-left: -999999px">
              <a ng-show="user.resend_link" title="Link copied to the clipboard" id="resend-link-button-{{ user.id }}" class="btn btn-xs btn-default"
                ng-click="$ctrl.copyLink(user)"><span class="glyphicon glyphicon-link"></span></a>
              <a class="btn btn-xs btn-primary" ng-click="$ctrl.resendLink(user)" ng-show="user.id !== $ctrl.user_id"><span class="glyphicon glyphicon-send"></span></a>
              <a class="btn btn-xs btn-danger" ng-click="$ctrl.deleteUser(user)" ng-show="user.id !== $ctrl.user_id"><span class="glyphicon glyphicon-trash"></span></a>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div style="flex: 0 0 auto;">
    <div class="pull-right">
      <nav aria-label="Page navigation">
        <ul class="pagination pagination-sm" style="display: inline; padding-right: 20px;">
          <li>
            <a href="#" aria-label="Previous" ng-click="$ctrl.selectPreviousPage()">
              <span aria-hidden="true">&laquo;</span>
            </a>
          </li>
          <li ng-repeat="page in $ctrl.pagination.visiblePages"
              ng-class="{ 'active': $ctrl.pagination.currentPage === page }">
            <a href="#" ng-click="$ctrl.selectPage(page)">{{page}}</a>
          </li>
          <li>
            <a href="#" aria-label="Next" ng-click="$ctrl.selectNextPage()">
              <span aria-hidden="true">&raquo;</span>
            </a>
          </li>
        </ul>
        <button class="btn btn-primary btn-sm" ng-click="$ctrl.saveUsers()"><i class="fa fa-save"></i>&nbsp;&nbsp;Save</button>
      </nav>
    </div>
  </div>
</div>

<!-- Spinner that will show up if the UI configuration is being loaded from the server -->
<div ng-show="$ctrl.isLoadingUsers" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; text-align: center; background-color: rgba(255, 255, 255, 0.7); z-index: 3;">
  <i class="fa fa-refresh fa-spin" style="font-size:48px; position: relative; top: 50%; transform: translateY(-50%); "></i>
</div>

<div ng-if="$ctrl.managerView === $ctrl.globalSettingsService.ManageUserViews.SendEmail">
  <form>
    <div class="form-group">
      <label>Subject</label>
      <input type="text" class="form-control" ng-model="$ctrl.globalSettingsService.mailSubject">
    </div>
    <div class="form-group">
      <label>Text</label>
      <textarea class="form-control" rows="10" ng-model="$ctrl.globalSettingsService.mailBody"></textarea>
    </div>
  </form>
</div>  

<div ng-if="$ctrl.managerView === $ctrl.globalSettingsService.ManageUserViews.RegisterUser">

  <form class="form-horizontal">  
  <div class="form-group">
    <label class="col-sm-4 control-label">First name</label>
    <div class="col-sm-8">
      <input type="text" class="form-control" ng-model="$ctrl.newUser.firstName">
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-4 control-label">Last name</label>
    <div class="col-sm-8">
      <input type="text" class="form-control" ng-model="$ctrl.newUser.lastName">
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-4 control-label">Email</label>
    <div class="col-sm-8">
      <input type="text" class="form-control" ng-model="$ctrl.newUser.email">
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-4 control-label">Confirm email</label>
    <div class="col-sm-8">
      <input type="text" class="form-control" ng-model="$ctrl.newUser.confirmEmail">
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-4 control-label">Company name</label>
    <div class="col-sm-8">
      <input type="text" class="form-control" ng-model="$ctrl.newUser.companyName">
    </div>
  </div>
  <div class="form-group">
    <label class="col-sm-4 control-label">Permissions</label>
    <div class="col-sm-8">
      <select class="form-control" ng-model="$ctrl.newUser.rol">
        <option value="">No permissions</option>
        <option value="biz-dev">Biz-Dev</option>
        <option value="admin">Admin</option>
        <option value="sales_engineer">Sales Engineer</option>
        <option value="account_exec">Account Executive</option>
      </select>
    </div>
  </div>
  </form>
  <button class="btn btn-primary pull-right" ng-click="$ctrl.registerUser()"><i class="fa fa-save"></i>&nbsp;&nbsp;Register user</button>
</div>
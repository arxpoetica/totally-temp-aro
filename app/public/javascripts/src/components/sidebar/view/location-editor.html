<style>
  .view-mode-container {
    position: relative; /* This will require the parent to have position: relative or absolute */
    height: 100%;
    padding: 0px 10px 10px 10px;
  }
  #tblLocationProperties td {
    line-height: 33px;  /* To vertically align text */
  }
</style>
<div class="view-mode-container">

  <!-- Add a component to handle map editing -->
  <map-object-editor map-global-object-name="{{$ctrl.mapGlobalObjectName}}"
                     map-container-id="map-canvas-container"
                     get-object-icon-url="$ctrl.getObjectIconUrl({objectKey, objectValue})"
                     get-object-selected-icon-url="$ctrl.getObjectSelectedIconUrl({objectKey, objectValue})"
                     modifying-library-id="$ctrl.currentTransaction.libraryId"
                     create-object-on-click="true"
                     allow-boundary-creation="false"
                     comms="{}"
                     on-create-object="$ctrl.handleObjectCreated(mapObject, usingMapClick, feature)"
                     on-modify-object="$ctrl.handleObjectModified(mapObject)"
                     on-select-object="$ctrl.handleSelectedObjectChanged(mapObject)"
                     on-delete-object="$ctrl.handleObjectDeleted(mapObject)"
                     register-object-delete-callback="$ctrl.registerObjectDeleteCallback(deleteObjectWithId)"
                     register-create-map-objects-callback="$ctrl.registerCreateMapObjectsCallback(createMapObjects)"
                     register-remove-map-objects-callback="$ctrl.registerRemoveMapObjectsCallback(removeMapObjects)">
  </map-object-editor>

  <!-- BEGIN section transaction details -->
  <div ng-if="$ctrl.currentTransaction">
    <div class="row">
      <div class="col-md-12" style="padding-bottom: 15px">
        Library <span class="label label-default">{{$ctrl.currentTransaction.libraryName}}</span>
        <div class="pull-right">transaction ID <span class="label label-default">{{$ctrl.currentTransaction.id}}</span></div>
      </div>
    </div>
    <div class="text-center">
      <div class="btn-group ">
        <button class="btn btn-default" ng-click="$ctrl.commitTransaction()"><i class="fa fa-check-circle"></i>&nbsp;&nbsp;Commit</button>
        <button class="btn btn-default" ng-click="$ctrl.discardTransaction()"><i class="fa fa-times-circle"></i>&nbsp;&nbsp;Discard</button>
      </div>
    </div>
    <br>
    <div ng-if="$ctrl.selectedMapObject" style="position: relative;">
      <table id="tblLocationProperties" class="table table-condensed table-striped" style="margin-bottom: 10px">
        <tr>
          <td>Location type:</td>
          <td>
            <select class="form-control"
                    ng-change="$ctrl.markSelectedLocationPropertiesDirty()"
                    ng-model="$ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].selectedLocationType"
                    ng-options="item for item in $ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].locationTypes">
            </select>
          </td>
        </tr>
        <tr>
          <td>Number of locations:</td>
          <td>
            <input class="form-control"
                  ng-change="$ctrl.markSelectedLocationPropertiesDirty(); $ctrl.setLastUsedNumberOfLocations($ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].numberOfLocations);"
                  ng-model="$ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].numberOfLocations">
          </td>
        </tr>
      </table>
      <button ng-class="{ 'btn btn-block': true,
                          'btn-default': !$ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].isDirty,
                          'btn-primary': $ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].isDirty }"
              ng-disabled="!$ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].isDirty"
              ng-click="$ctrl.saveSelectedLocationAndProperties()">
        <i class="fa fa-save"></i>&nbsp;&nbsp;Save properties
      </button>
      <!-- Show a delete button if a map object is selected -->
      <button class="btn btn-block btn-danger" ng-click="$ctrl.deleteSelectedObject()" style="margin-top: 10px">
        <i class="fa fa-trash"></i>&nbsp;&nbsp;Delete selected location
      </button>

      <!-- Add a div that will overlay all the controls above. The div will be visible when the controls need to be disabled. -->
      <div class="disable-sibling-controls"
           ng-hide="!$ctrl.objectIdToProperties[$ctrl.selectedMapObject.objectId].isLocked">
        <i class="fa fa-5x fa-lock" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);"></i>
      </div>

    </div>
    <br>
    Number of changes in transaction: {{$ctrl.getFeaturesCount()}}
  </div>
  <!-- END section transaction details -->
</div>

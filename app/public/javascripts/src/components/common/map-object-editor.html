<!-- Define a dummy CSS class that we will use to select the dropdown element. The class name
     must be unique as all this HTML is going to be attached to the $document -->
<style>
  .map-object-editor-context-menu-container {
    line-height: 22px; /* Any property will do */
  }
  .map-object-editor-context-menu {
    line-height: 22px; /* Any property will do */
  }
  .map-object-editor-context-menu-dropdown {
    line-height: 22px; /* Any property will do */
    padding: 5px;
  }
  .map-object-drop-targets-container {
    line-height: 22px; /* Any property will do */
  }
  .map-object-editor-context-menu-dropdown-section{
    margin-bottom: 6px;
  }
</style>
<div class="map-object-editor-context-menu-container" ng-style="$ctrl.contextMenuCss"> <!-- This ng-style will position the menu -->
  <div class="dropdown">
    <!-- Have a button but hide it. This markup is from the standard bootstrap dropdown docs.
         The .dropdown() method is called on this hidden button, which in turn shows the menu. -->
    <button ng-hide="true" class="btn btn-default dropdown-toggle map-object-editor-context-menu" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
      Dropdown
      <span class="caret"></span>
    </button>
    
    <!-- 
    <ul class="dropdown-menu map-object-editor-context-menu-dropdown" aria-labelledby="dropdownMenu1">
      <li><a href="#" ng-click="$ctrl.deleteSelectedObject()"><i class="fa fa-trash"></i>&nbsp;&nbsp;Delete</a></li>
      <li ng-if="!$ctrl.isMarker($ctrl.selectedMapObject)">
        <a href="#" ng-click="$ctrl.toggleEditSelectedPolygon()">
          <i ng-if="$ctrl.selectedMapObject.getEditable()" class="fa fa-stop"></i>
          <i ng-if="!$ctrl.selectedMapObject.getEditable()" class="fa fa-pencil"></i>
          &nbsp;&nbsp;{{$ctrl.selectedMapObject.getEditable() ? 'Stop Editing' : 'Edit boundary'}}
        </a>
      </li>
      <li ng-if="$ctrl.isMarker($ctrl.selectedMapObject) && $ctrl.allowBoundaryCreation">
        <a href="#" ng-click="$ctrl.startDrawingBoundaryFor($ctrl.selectedMapObject)"><i class="fa fa-plus"></i> Add boundary</a>
      </li>
    </ul>
    -->
    
    
    
    <ul class="dropdown-menu map-object-editor-context-menu-dropdown" aria-labelledby="dropdownMenu1">
      <!-- Menu item to delete object -->
      <div class="map-object-editor-context-menu-dropdown-section" ng-repeat="item in $ctrl.menuItems">
        <li>
          {{item.name}}
        </li>
        <li ng-repeat="option in item.options">
          <a ng-if=" 'select' == option "
             href="#" ng-click="$ctrl.selectProposedFeature(item.objectId)">
            &nbsp;&nbsp;<i class="fa fa-pencil"></i>
            Select
          </a>
          <a ng-if=" 'edit existing' == option "
             href="#" ng-click="$ctrl.editExistingFeature(item.feature, item.latLng)">
            &nbsp;&nbsp;<i class="fa fa-pencil"></i>
            Select
          </a>
          <a ng-if=" 'add boundary' == option "
             href="#" ng-click="$ctrl.startDrawingBoundaryForId(item.objectId)">
            &nbsp;&nbsp;<i class="fa fa-plus"></i>
            Add Boundary
          </a>
          <a ng-if=" 'edit boundary' == option "
             href="#" ng-click="$ctrl.editBoundary(item.objectId)">
            &nbsp;&nbsp;<i class="fa fa-pencil"></i>
            Edit Boundary
          </a>
          <a ng-if=" 'delete' == option "
             href="#" ng-click="$ctrl.deleteObjectWithId(item.objectId)">
            &nbsp;&nbsp;<i class="fa fa-trash"></i>
            Delete
          </a>
        </li>
      </div>
      
      
      <!-- 
      <li><a href="#" ng-click="$ctrl.deleteSelectedObject()"><i class="fa fa-trash"></i>&nbsp;&nbsp;Delete</a></li>
      <li ng-if="!$ctrl.isMarker($ctrl.selectedMapObject)">
        <a href="#" ng-click="$ctrl.toggleEditSelectedPolygon()">
          <i ng-if="$ctrl.selectedMapObject.getEditable()" class="fa fa-stop"></i>
          <i ng-if="!$ctrl.selectedMapObject.getEditable()" class="fa fa-pencil"></i>
          &nbsp;&nbsp;{{$ctrl.selectedMapObject.getEditable() ? 'Stop Editing' : 'Edit boundary'}}
        </a>
      </li>
      <li ng-if="$ctrl.isMarker($ctrl.selectedMapObject) && $ctrl.allowBoundaryCreation">
        <a href="#" ng-click="$ctrl.startDrawingBoundaryFor($ctrl.selectedMapObject)"><i class="fa fa-plus"></i> Add boundary</a>
      </li>
      -->
    </ul>
    
    
    
  </div>
</div>
<!-- A div containing the drop targets, used when dropping boundaries onto equipments. Do NOT set
     the width or height of the DIV, otherwise it will eat up all mouse events. Even setting pointer-events:none
     does not help, because then the drop event on the drop targets does not work either -->
<div class="map-object-drop-targets-container" style="position: absolute; left: 0px; top: 0px;">
  <drop-target ng-repeat="(key, mapObject) in $ctrl.createdMapObjects"
               ng-if="$ctrl.isHavingBoundaryDraggedOver && $ctrl.getDropTargetCSSForMapObject(mapObject)"
               ng-style="$ctrl.getDropTargetCSSForMapObject(mapObject)"
               target-object-id="mapObject.objectId"
               on-dropped="$ctrl.handleOnDropped({dropEvent: dropEvent, targetObjectId: targetObjectId})">
  </drop-target>
</div>
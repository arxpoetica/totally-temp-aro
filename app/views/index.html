<!DOCTYPE html>
<html ng-app="aro">
  <head>
    <title>ARO</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/aro.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;libraries=geometry"></script>
    <script>

      var app = angular.module('aro', []);
      var map;
      
      function initialize() {
        map = new google.maps.Map(document.getElementById('map-canvas'), {
          zoom: 12,
          center: {lat: 47.6097, lng: -122.3331}, // Centroid of Seattle, WA
          mapTypeId: google.maps.MapTypeId.HYBRID,
          panControl: false,
          zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL,
            position: google.maps.ControlPosition.TOP_RIGHT
          },
          mapTypeControlOptions: {
            position: google.maps.ControlPosition.TOP_RIGHT
          }
        });
      }

      google.maps.event.addDomListener(window, 'load', initialize);

    </script>
  </head>
  <body>
      <div id="left-col">
        <div ng-controller="map_layers_controller">
          <div ng-repeat="(key, layer) in area_layers">
            <div class="layer-toggle" ng-class="{'layer-toggle-visible': layer.visible}">
              <a href="#" ng-click="layer.toggle_visibility()">{{layer.short_name}}</a>
            </div>
          </div>
          <div ng-repeat="(key, layer) in feature_layers">
            <div class="layer-toggle" ng-class="{'layer-toggle-visible': layer.visible}">
              <a href="#" ng-click="layer.toggle_visibility()">{{layer.short_name}}</a>
            </div>
          </div>
        </div>

        <hr>

        <div ng-controller="map_tools_controller">
          <div class="tool-toggle">
            <a href="#" ng-click="toggle_tool_visibility()">DBR</a>
          </div>
        </div>
      </div>

      <div ng-controller="selected_location_controller">
        <div ng-show="is_visible" class="tool-location-container">
          <form ng-show="location.location_id">
            <p><label>Number of households: </label> <input ng-model="location.number_of_households"></input></p>
            <button type="submit" ng-click="update()">Update</button>
          </form>
          <div ng-show="!location.location_id">
            Right click on any location
          </div>
        </div>
      </div>

      <div ng-controller="shortest_path_controller">
        <div ng-show="is_visible" class="tool-opts-container">
          <div class="tool-opts-title">Distance Based Route Plan</div>

          <!-- Route Creation Inputs -->
          <div class="tool-opts">
            <div>
              <label>Sources: </label> {{selection.sources.length()}}
            </div>
            <div>
              <label>Targets: </label> {{selection.targets.length()}}
            </div>
            <div>
              <button class="tool-button" ng-click="draw_rectangle()" type="button">Select drawing rectangle</button>
            </div>
            <div>
              <button class="tool-button" ng-click="select_in_rectangle()" type="button">Add features within rectangle</button>
            </div>
            <div>
              <label>Cable Type:</label>
              <select>
                <option value="aerial">Aerial</option>
                <option value="buried">Buried</option>
              </select>
            </div>
            <div>
              <button class="tool-button" ng-click="create_route()" type="button">Plan Route</button>
            </div>

            <!-- Route Financials -->
            <div ng-show="route_layer.visible">
              <p>Route Financials:</p>
              <label>Total Cost: </label> {{route_layer.metadata.total_cost | currency}}
              <button class="tool-button" ng-click="clear_route()" type="button">Clear Route</button>
            </div>
          </div>
        </div>
      </div>

    <div id="map-canvas"></div>
    
  </body>

  <!-- Angular controllers and services -->
  <script src="javascripts/libs/underscore.js"></script>
  <script src="javascripts/controllers/map_layers_controller.js"></script>
  <script src="javascripts/controllers/map_tools_controller.js"></script>
  <script src="javascripts/controllers/shortest_path_controller.js"></script>
  <script src="javascripts/controllers/selected_location_controller.js"></script>
  <script src="javascripts/models/map_layer.js"></script>
  <script src="javascripts/models/selection.js"></script>
</html>

<div>
  <div class="modal" id="create-location" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Create location</h4>
        </div>
        <div class="modal-body">
          <form class="form-horizontal">
            <div class="form-group" ng-show="selected_tool === 'commercial' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Business name</label>
              <div class="col-sm-8">
                <input class="form-control" ng-model="new_location_data.business_name">
              </div>
            </div>
            <div class="form-group" ng-show="selected_tool === 'commercial' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Number of employees</label>
              <div class="col-sm-8">
                <input class="form-control" ng-model="new_location_data.number_of_employees">
              </div>
            </div>
            <div class="form-group" ng-show="selected_tool === 'commercial' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Business industry</label>
              <div class="col-sm-8">
                <select class="form-control industries" ng-model="new_location_data.business_industry" ng-options="industry.text for industry in industries"></select>
              </div>
            </div>
            <div class="form-group" ng-show="selected_tool === 'commercial' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Annual recurring cost</label>
              <div class="col-sm-8">
                <input class="form-control" ng-model="new_location_data.annual_recurring_cost">
              </div>
            </div>
            <div class="form-group" ng-show="selected_tool === 'commercial' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Install cost</label>
              <div class="col-sm-8">
                <input class="form-control" ng-model="new_location_data.install_cost">
              </div>
            </div>
            <div class="form-group" ng-show="selected_tool === 'commercial' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Business customer type</label>
              <div class="col-sm-8">
                <select class="form-control businesses_customer_types" ng-model="new_location_data.business_customer_type" ng-options="customer_type.name for customer_type in customer_types"></select>
              </div>
            </div>
            <div class="form-group" ng-show="selected_tool === 'residential' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Number of households</label>
              <div class="col-sm-8">
                <input class="form-control" ng-model="new_location_data.number_of_households">
              </div>
            </div>
            <div class="form-group" ng-show="selected_tool === 'residential' || selected_tool === 'combo'">
              <label class="col-sm-4 control-label">Household customer type</label>
              <div class="col-sm-8">
                <select class="form-control households_customer_types" ng-model="new_location_data.household_customer_type" ng-options="customer_type.name for customer_type in customer_types"></select>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" ng-click="create_location()">Create location</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Locations layer modal -->
  <div id="locations_controller" ng-show="!isLoadingConfiguration">

    <form>
      <!-- Businesses -->
      <div class="customer-type shaded">
        <label>Locations</label>
      </div>
      <div ng-repeat="locationType in planState.locationTypes" style="clear:both" class="customer-type">
        <label class="pull-right">
          <span class="fa fa-repeat map-layer-spinner map-layer-spinner-locations" ng-show="business_categories_selected[locationType.key]"></span>
          <input type="checkbox"
                 ng-model="locationType.checked"
                 ng-change="changeLocationsLayer()">
        </label>
        <div class="pull-left">
          <img ng-src="{{locationType.icon}}" style="width:16px;margin-right:10px">
        </div>
        <label>{{locationType.label}}</label>
      </div>

      <!-- Data sources -->
      <!-- Global businesses -->
      <div class="customer-type shaded">
        <label>Location data sources</label>
      </div>
      <!-- Uploaded data sources -->
      <div class="customer-type">
        <ui-select multiple ng-model="planState.locationDataSources"
                   theme="bootstrap"
                   close-on-select="true"
                   on-select="changeLocationsLayer()"
                   on-remove="changeLocationsLayer()">
          <ui-select-match placeholder="Select data sources...">{{$item.name}} [id {{$item.dataSourceId}}]</ui-select-match>
          <ui-select-choices class="ui-select-width-300" repeat="uploadedDataSource in allUploadedDataSources">
            <div>{{uploadedDataSource.name}}</div>
          </ui-select-choices>
        </ui-select>
        <button class="btn btn-sm btn-primary btn-block" style="margin: 5px 0" ng-click="addCustomers()">
          <span class="fa fa-plus"></span> Add data sources...
        </button>
      </div>
    </form>

    <div class="alert alert-info text-center" role="alert" ng-show="heatmapVisible">
      To see individual locations, zoom in or turn off the heatmap button below the zoom buttons
    </div>

    <a ng-if="env_is_test" href="javascript:void(0)" ng-click="locations_layer.select_random_features()" ng-attr-data-loaded="{{locations_layer.data_loaded}}">Test</a>
  </div>

  <!-- Spinner that will be shown while the configuration is being loaded from the server -->
  <div style="margin:30px;text-align:center;" ng-if="isLoadingConfiguration">
    <p>Loading location categories</p>
    <div class="spinner">
      <div class="rect1"></div>
      <div class="rect2"></div>
      <div class="rect3"></div>
      <div class="rect4"></div>
      <div class="rect5"></div>
    </div>
  </div>
</div>
